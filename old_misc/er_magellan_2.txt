CUDA_VISIBLE_DEVICES=0 python train_ditto.py               --task Textual/Abt-Buy               --logdir results_ditto/               --finetuning               --batch_size 32               --lr 3e-5               --fp16               --lm roberta               --n_epochs 15               --run_id 0 --da swap --dk general
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.



Defaults for this optimization level are:

enabled                : True

opt_level              : O2

cast_model_type        : torch.float16

patch_torch_functions  : False

keep_batchnorm_fp32    : True

master_weights         : True

loss_scale             : dynamic

Processing user overrides (additional kwargs that are not None)...

After processing overrides, optimization options are:

enabled                : True

opt_level              : O2

cast_model_type        : torch.float16

patch_torch_functions  : False

keep_batchnorm_fp32    : True

master_weights         : True

loss_scale             : dynamic

Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")

Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0

step: 0, loss: 0.5105817317962646

Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0

step: 10, loss: 0.3314405381679535

step: 20, loss: 0.1698639839887619

step: 30, loss: 0.3098730146884918

step: 40, loss: 0.4241997301578522

step: 50, loss: 0.37939831614494324

step: 60, loss: 0.31469130516052246

step: 70, loss: 0.2600642144680023

step: 80, loss: 0.24791219830513

step: 90, loss: 0.31064432859420776

step: 100, loss: 0.2772965133190155

step: 110, loss: 0.2660661041736603

step: 120, loss: 0.2547406256198883

step: 130, loss: 0.35585248470306396

step: 140, loss: 0.4076954126358032

step: 150, loss: 0.4481342136859894

step: 160, loss: 0.3668522536754608

step: 170, loss: 0.3711472749710083

epoch 1: dev_f1=0.1941564561734213, f1=0.1941564561734213, best_f1=0.1941564561734213

step: 0, loss: 0.30213236808776855

step: 10, loss: 0.2922736704349518

step: 20, loss: 0.30071210861206055

step: 30, loss: 0.37356528639793396

step: 40, loss: 0.11284118890762329

step: 50, loss: 0.3830846846103668

step: 60, loss: 0.11509092152118683

step: 70, loss: 0.24409990012645721

step: 80, loss: 0.29020774364471436

step: 90, loss: 0.4383471608161926

step: 100, loss: 0.16997389495372772

step: 110, loss: 0.45787864923477173

Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0

step: 120, loss: 0.3723278343677521

step: 130, loss: 0.26457998156547546

step: 140, loss: 0.4749000072479248

step: 150, loss: 0.24779675900936127

step: 160, loss: 0.20267900824546814

step: 170, loss: 0.1806192547082901

epoch 2: dev_f1=0.1941564561734213, f1=0.1941564561734213, best_f1=0.1941564561734213

step: 0, loss: 0.3114713430404663

step: 10, loss: 0.23946881294250488

step: 20, loss: 0.11595847457647324

step: 30, loss: 0.1623227894306183

step: 40, loss: 0.23819854855537415

step: 50, loss: 0.16636469960212708

step: 60, loss: 0.18422247469425201

step: 70, loss: 0.3789338767528534

step: 80, loss: 0.16687259078025818

step: 90, loss: 0.45652854442596436

step: 100, loss: 0.27142849564552307

step: 110, loss: 0.329855352640152

step: 120, loss: 0.42980989813804626

step: 130, loss: 0.1345864087343216

step: 140, loss: 0.11102822422981262

step: 150, loss: 0.30780351161956787

step: 160, loss: 0.4263107478618622

step: 170, loss: 0.44676336646080017

epoch 3: dev_f1=0.1941564561734213, f1=0.1941564561734213, best_f1=0.1941564561734213

step: 0, loss: 0.2412770688533783

step: 10, loss: 0.3217509090900421

step: 20, loss: 0.23510754108428955

step: 30, loss: 0.30555260181427

step: 40, loss: 0.2750323414802551

step: 50, loss: 0.17084482312202454

step: 60, loss: 0.2356148362159729

step: 70, loss: 0.5052105188369751

step: 80, loss: 0.31008023023605347

step: 90, loss: 0.471682071685791

step: 100, loss: 0.3154890537261963

step: 110, loss: 0.4321790933609009

step: 120, loss: 0.24869711697101593

step: 130, loss: 0.13952767848968506

step: 140, loss: 0.37730854749679565

step: 150, loss: 0.3198682963848114

step: 160, loss: 0.2587883770465851

step: 170, loss: 0.26708731055259705

epoch 4: dev_f1=0.22316865417376489, f1=0.22980251346499106, best_f1=0.22980251346499106

step: 0, loss: 0.439723402261734

step: 10, loss: 0.13549712300300598

step: 20, loss: 0.3676537275314331

step: 30, loss: 0.3059358596801758

step: 40, loss: 0.24500325322151184

step: 50, loss: 0.2886659801006317

step: 60, loss: 0.3823390603065491

step: 70, loss: 0.25760042667388916

step: 80, loss: 0.16174086928367615

step: 90, loss: 0.26552918553352356

step: 100, loss: 0.37395191192626953

step: 110, loss: 0.30997923016548157

step: 120, loss: 0.38765281438827515

step: 130, loss: 0.17815764248371124

step: 140, loss: 0.32088616490364075

step: 150, loss: 0.4488672912120819

step: 160, loss: 0.2438804805278778

step: 170, loss: 0.24917320907115936

epoch 5: dev_f1=0.1941564561734213, f1=0.1941564561734213, best_f1=0.22980251346499106

step: 0, loss: 0.23891432583332062

step: 10, loss: 0.2529735565185547

step: 20, loss: 0.23873601853847504

step: 30, loss: 0.32716336846351624

step: 40, loss: 0.3789388835430145

step: 50, loss: 0.38317859172821045

step: 60, loss: 0.1361452341079712

step: 70, loss: 0.327160120010376

step: 80, loss: 0.27757197618484497

step: 90, loss: 0.28150683641433716

step: 100, loss: 0.37826547026634216

step: 110, loss: 0.5512152910232544

step: 120, loss: 0.250938355922699

step: 130, loss: 0.30462777614593506

step: 140, loss: 0.30183303356170654

step: 150, loss: 0.2423063963651657

step: 160, loss: 0.37203535437583923

step: 170, loss: 0.40830376744270325

epoch 6: dev_f1=0.2523809523809524, f1=0.2574416733708769, best_f1=0.2574416733708769

step: 0, loss: 0.27067363262176514

step: 10, loss: 0.24424412846565247

step: 20, loss: 0.40327978134155273

step: 30, loss: 0.5649744272232056

step: 40, loss: 0.2976113259792328

step: 50, loss: 0.48427724838256836

step: 60, loss: 0.5029304623603821

step: 70, loss: 0.2810449004173279

step: 80, loss: 0.5700690150260925

step: 90, loss: 0.304975301027298

step: 100, loss: 0.4416247606277466

step: 110, loss: 0.35929012298583984

step: 120, loss: 0.25851935148239136

step: 130, loss: 0.384443074464798

step: 140, loss: 0.31512609124183655

step: 150, loss: 0.12269561737775803

step: 160, loss: 0.11799682676792145

step: 170, loss: 0.2258923202753067

epoch 7: dev_f1=0.6360153256704981, f1=0.5942857142857143, best_f1=0.5942857142857143

step: 0, loss: 0.21022379398345947

step: 10, loss: 0.02679925039410591

step: 20, loss: 0.3985803723335266

step: 30, loss: 0.265622079372406

step: 40, loss: 0.3788931667804718

step: 50, loss: 0.20452958345413208

step: 60, loss: 0.1277371346950531

step: 70, loss: 0.2961914539337158

step: 80, loss: 0.30827796459198

step: 90, loss: 0.13565100729465485

step: 100, loss: 0.34114882349967957

step: 110, loss: 0.20704053342342377

step: 120, loss: 0.08314907550811768

step: 130, loss: 0.06456277519464493

step: 140, loss: 0.23101091384887695

step: 150, loss: 0.18958023190498352

step: 160, loss: 0.14044028520584106

step: 170, loss: 0.19294609129428864

epoch 8: dev_f1=0.6855983772819472, f1=0.6470588235294117, best_f1=0.6470588235294117

step: 0, loss: 0.23769819736480713

step: 10, loss: 0.09379339218139648

step: 20, loss: 0.23141495883464813

step: 30, loss: 0.07210007309913635

step: 40, loss: 0.28101515769958496

step: 50, loss: 0.10970722138881683

step: 60, loss: 0.10239645093679428

step: 70, loss: 0.27501729130744934

step: 80, loss: 0.11948326975107193

step: 90, loss: 0.28171589970588684

step: 100, loss: 0.07027792185544968

step: 110, loss: 0.04100723937153816

step: 120, loss: 0.0807754322886467

step: 130, loss: 0.3069652318954468

step: 140, loss: 0.06095672771334648

step: 150, loss: 0.16466911137104034

step: 160, loss: 0.056893639266490936

step: 170, loss: 0.1459798365831375

epoch 9: dev_f1=0.7531380753138074, f1=0.6918489065606361, best_f1=0.6918489065606361

step: 0, loss: 0.059581682085990906

step: 10, loss: 0.06468548625707626

step: 20, loss: 0.027602950111031532

step: 30, loss: 0.07553592324256897

step: 40, loss: 0.10467559099197388

step: 50, loss: 0.17623844742774963

step: 60, loss: 0.2202954739332199

step: 70, loss: 0.10452885925769806

step: 80, loss: 0.018971549347043037

step: 90, loss: 0.11396955698728561

step: 100, loss: 0.18183253705501556

step: 110, loss: 0.03270593658089638

step: 120, loss: 0.17878128588199615

step: 130, loss: 0.3007987141609192

step: 140, loss: 0.045309972018003464

step: 150, loss: 0.0313112698495388

step: 160, loss: 0.06839360296726227

step: 170, loss: 0.09511785954236984

epoch 10: dev_f1=0.7705263157894737, f1=0.7494908350305499, best_f1=0.7494908350305499

step: 0, loss: 0.1397126019001007

step: 10, loss: 0.0330706387758255

step: 20, loss: 0.1336456537246704

step: 30, loss: 0.04177146404981613

step: 40, loss: 0.0830485001206398

step: 50, loss: 0.060561951249837875

step: 60, loss: 0.08954919874668121

step: 70, loss: 0.0701354444026947

step: 80, loss: 0.1321055144071579

step: 90, loss: 0.08720479905605316

step: 100, loss: 0.06438371539115906

step: 110, loss: 0.04621543735265732

step: 120, loss: 0.028562188148498535

step: 130, loss: 0.012606661766767502

step: 140, loss: 0.12512679398059845

step: 150, loss: 0.08457629382610321

step: 160, loss: 0.12753278017044067

step: 170, loss: 0.11760897934436798

epoch 11: dev_f1=0.7955056179775281, f1=0.7833698030634573, best_f1=0.7833698030634573

step: 0, loss: 0.06517525017261505

step: 10, loss: 0.03986941650509834

step: 20, loss: 0.038049545139074326

step: 30, loss: 0.13913461565971375

step: 40, loss: 0.12063660472631454

step: 50, loss: 0.058599233627319336

step: 60, loss: 0.12046252936124802

step: 70, loss: 0.076912522315979

step: 80, loss: 0.06302910298109055

step: 90, loss: 0.02980007231235504

step: 100, loss: 0.04927736520767212

step: 110, loss: 0.02639220841228962

step: 120, loss: 0.1284126341342926

step: 130, loss: 0.08428945392370224

step: 140, loss: 0.03158615902066231

step: 150, loss: 0.05227191001176834

step: 160, loss: 0.0298960842192173

step: 170, loss: 0.0789850726723671

epoch 12: dev_f1=0.7952380952380952, f1=0.7954545454545455, best_f1=0.7833698030634573

step: 0, loss: 0.03467094153165817

step: 10, loss: 0.10744895786046982

step: 20, loss: 0.06422074884176254

step: 30, loss: 0.059988588094711304

step: 40, loss: 0.004621951840817928

step: 50, loss: 0.005956468638032675

step: 60, loss: 0.01067726593464613

step: 70, loss: 0.1716587394475937

step: 80, loss: 0.29561805725097656

step: 90, loss: 0.4332498013973236

step: 100, loss: 0.13725446164608002

step: 110, loss: 0.060855764895677567

step: 120, loss: 0.06055053696036339

step: 130, loss: 0.08129613846540451

step: 140, loss: 0.050065066665410995

step: 150, loss: 0.06020255759358406

step: 160, loss: 0.007674293126910925

step: 170, loss: 0.027578679844737053

epoch 13: dev_f1=0.800982800982801, f1=0.8142857142857144, best_f1=0.8142857142857144

step: 0, loss: 0.02893473021686077

step: 10, loss: 0.01425472367554903

step: 20, loss: 0.09088368713855743

step: 30, loss: 0.21247169375419617

step: 40, loss: 0.060825541615486145

step: 50, loss: 0.16199596226215363

step: 60, loss: 0.033999864012002945

step: 70, loss: 0.09718579053878784

step: 80, loss: 0.020501093938946724

step: 90, loss: 0.03906506672501564

step: 100, loss: 0.07823175191879272

step: 110, loss: 0.03874162212014198

step: 120, loss: 0.052767202258110046

step: 130, loss: 0.03649097681045532

step: 140, loss: 0.2040102332830429

step: 150, loss: 0.0065537397749722

step: 160, loss: 0.006209707818925381

step: 170, loss: 0.1930810660123825

epoch 14: dev_f1=0.7928730512249442, f1=0.7974137931034483, best_f1=0.8142857142857144

step: 0, loss: 0.01396587397903204

step: 10, loss: 0.25702065229415894

step: 20, loss: 0.10687299817800522

step: 30, loss: 0.011643593199551105

step: 40, loss: 0.03746158629655838

step: 50, loss: 0.04310578852891922

step: 60, loss: 0.01705925166606903

step: 70, loss: 0.03804808855056763

step: 80, loss: 0.03143841400742531

step: 90, loss: 0.03694203123450279

step: 100, loss: 0.12643003463745117

step: 110, loss: 0.004305643495172262

step: 120, loss: 0.015695812180638313

step: 130, loss: 0.04957834258675575

step: 140, loss: 0.14149613678455353

step: 150, loss: 0.007371137384325266

step: 160, loss: 0.07341713458299637

step: 170, loss: 0.010558785870671272

epoch 15: dev_f1=0.8031088082901555, f1=0.8117359413202935, best_f1=0.8117359413202935
































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































0
CUDA_VISIBLE_DEVICES=0 python train_ditto.py               --task Textual/Abt-Buy               --logdir results_ditto/               --finetuning               --batch_size 32               --lr 3e-5               --fp16               --lm roberta               --n_epochs 15               --run_id 1 --da swap --dk general
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.



Defaults for this optimization level are:

enabled                : True

opt_level              : O2

cast_model_type        : torch.float16

patch_torch_functions  : False

keep_batchnorm_fp32    : True

master_weights         : True

loss_scale             : dynamic

Processing user overrides (additional kwargs that are not None)...

After processing overrides, optimization options are:

enabled                : True

opt_level              : O2

cast_model_type        : torch.float16

patch_torch_functions  : False

keep_batchnorm_fp32    : True

master_weights         : True

loss_scale             : dynamic

Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")

Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0

step: 0, loss: 0.9180102348327637

Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0

Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0

step: 10, loss: 0.1851710081100464

step: 20, loss: 0.2679998576641083

step: 30, loss: 0.4552963376045227

step: 40, loss: 0.3436444401741028

step: 50, loss: 0.15509355068206787

step: 60, loss: 0.2589327096939087

step: 70, loss: 0.17364412546157837

step: 80, loss: 0.33746781945228577

step: 90, loss: 0.16431590914726257

step: 100, loss: 0.36027637124061584

step: 110, loss: 0.2356589436531067

step: 120, loss: 0.38019412755966187

step: 130, loss: 0.2984413802623749

step: 140, loss: 0.31289300322532654

step: 150, loss: 0.5613452792167664

step: 160, loss: 0.1861056238412857

step: 170, loss: 0.39039596915245056

epoch 1: dev_f1=0.4371584699453551, f1=0.3938814531548757, best_f1=0.3938814531548757

step: 0, loss: 0.22038571536540985

step: 10, loss: 0.1554318219423294

step: 20, loss: 0.3047027587890625

step: 30, loss: 0.27478858828544617

step: 40, loss: 0.06336849927902222

step: 50, loss: 0.16696934401988983

step: 60, loss: 0.1326122134923935

step: 70, loss: 0.2002582848072052

step: 80, loss: 0.16961126029491425

step: 90, loss: 0.14658571779727936

step: 100, loss: 0.4562225341796875

step: 110, loss: 0.3398384749889374

step: 120, loss: 0.03481772169470787

step: 130, loss: 0.20855256915092468

step: 140, loss: 0.049564436078071594

step: 150, loss: 0.17478571832180023

step: 160, loss: 0.2633535861968994

step: 170, loss: 0.13946746289730072

epoch 2: dev_f1=0.8221709006928406, f1=0.8300220750551875, best_f1=0.8300220750551875

step: 0, loss: 0.053905319422483444

step: 10, loss: 0.03958471864461899

step: 20, loss: 0.054018035531044006

step: 30, loss: 0.17733262479305267

step: 40, loss: 0.023912901058793068

step: 50, loss: 0.06480702012777328

step: 60, loss: 0.06232944875955582

step: 70, loss: 0.03881602734327316

step: 80, loss: 0.07885705679655075

step: 90, loss: 0.15381647646427155

step: 100, loss: 0.0130399689078331

step: 110, loss: 0.09374739974737167

step: 120, loss: 0.02122022584080696

step: 130, loss: 0.14945846796035767

step: 140, loss: 0.1565539836883545

step: 150, loss: 0.08524201810359955

step: 160, loss: 0.08643808960914612

step: 170, loss: 0.05643200874328613

epoch 3: dev_f1=0.8411214953271028, f1=0.8677494199535962, best_f1=0.8677494199535962

step: 0, loss: 0.022965749725699425

step: 10, loss: 0.042272403836250305

step: 20, loss: 0.0797945186495781

step: 30, loss: 0.1008971631526947

step: 40, loss: 0.05109644681215286

step: 50, loss: 0.14360255002975464

step: 60, loss: 0.18516309559345245

step: 70, loss: 0.10050857067108154

step: 80, loss: 0.02457931451499462

step: 90, loss: 0.03389322757720947

step: 100, loss: 0.10977157950401306

step: 110, loss: 0.051634322851896286

step: 120, loss: 0.25492194294929504

step: 130, loss: 0.0676623061299324

step: 140, loss: 0.12669894099235535

step: 150, loss: 0.022329624742269516

step: 160, loss: 0.0006300125969573855

step: 170, loss: 0.09657449275255203

epoch 4: dev_f1=0.8712871287128712, f1=0.8958837772397095, best_f1=0.8958837772397095

step: 0, loss: 0.10556589812040329

step: 10, loss: 0.28990331292152405

step: 20, loss: 0.15874558687210083

step: 30, loss: 0.02635219506919384

step: 40, loss: 0.07687496393918991

step: 50, loss: 0.0056864432990550995

step: 60, loss: 0.08380094170570374

step: 70, loss: 0.03181929886341095

step: 80, loss: 0.017104793339967728

step: 90, loss: 0.00988541916012764

step: 100, loss: 0.058041784912347794

step: 110, loss: 0.03688811510801315

step: 120, loss: 0.0039886776357889175

step: 130, loss: 0.004162084776908159

step: 140, loss: 0.014430216513574123

step: 150, loss: 0.32063964009284973

step: 160, loss: 0.046176426112651825

step: 170, loss: 0.01046532392501831

epoch 5: dev_f1=0.86810551558753, f1=0.8697674418604652, best_f1=0.8958837772397095

step: 0, loss: 0.012142476625740528

step: 10, loss: 0.03801343962550163

step: 20, loss: 0.02709401585161686

step: 30, loss: 0.029970740899443626

step: 40, loss: 0.05716291442513466

step: 50, loss: 0.0010971567826345563

step: 60, loss: 0.0019404292106628418

step: 70, loss: 0.013067426159977913

step: 80, loss: 0.024500999599695206

step: 90, loss: 0.0035342087503522635

step: 100, loss: 0.0015004669548943639

step: 110, loss: 0.013191543519496918

step: 120, loss: 0.01559804193675518

step: 130, loss: 0.004815676249563694

step: 140, loss: 0.01936331018805504

step: 150, loss: 0.004142133053392172

step: 160, loss: 0.0010275131789967418

step: 170, loss: 0.1732168197631836

epoch 6: dev_f1=0.8532110091743119, f1=0.8635346756152126, best_f1=0.8958837772397095

step: 0, loss: 0.002671291120350361

step: 10, loss: 0.0022961595095694065

step: 20, loss: 0.0037943096831440926

step: 30, loss: 0.006281339563429356

step: 40, loss: 0.15271705389022827

step: 50, loss: 0.07857844978570938

step: 60, loss: 0.007999229244887829

step: 70, loss: 0.005538041237741709

step: 80, loss: 0.11281859874725342

step: 90, loss: 0.007858812808990479

step: 100, loss: 0.15204383432865143

step: 110, loss: 0.033745717257261276

step: 120, loss: 0.005757574923336506

step: 130, loss: 0.010729419067502022

step: 140, loss: 0.008850553072988987

step: 150, loss: 0.0042750416323542595

step: 160, loss: 0.01790338009595871

step: 170, loss: 0.007946060039103031

epoch 7: dev_f1=0.8759493670886076, f1=0.8861985472154963, best_f1=0.8861985472154963

step: 0, loss: 0.008634411729872227

step: 10, loss: 0.0030577450525015593

step: 20, loss: 0.005712219048291445

step: 30, loss: 0.0017887213034555316

step: 40, loss: 0.002853918354958296

step: 50, loss: 0.04209655895829201

step: 60, loss: 0.0024097056593745947

step: 70, loss: 0.0002294938312843442

step: 80, loss: 0.0009383310098201036

step: 90, loss: 0.012304592877626419

step: 100, loss: 0.053300097584724426

step: 110, loss: 0.0025606437120586634

step: 120, loss: 0.052406493574380875

step: 130, loss: 0.013938603922724724

step: 140, loss: 0.019675197079777718

step: 150, loss: 0.0003916782734449953

step: 160, loss: 0.004129933193325996

step: 170, loss: 0.042761221528053284

epoch 8: dev_f1=0.8459657701711493, f1=0.8564593301435406, best_f1=0.8861985472154963

step: 0, loss: 0.08658977597951889

step: 10, loss: 0.0047782291658222675

step: 20, loss: 0.027570072561502457

step: 30, loss: 0.03571728616952896

step: 40, loss: 0.002801524242386222

step: 50, loss: 0.025554725900292397

step: 60, loss: 0.0386161282658577

step: 70, loss: 0.01849319227039814

step: 80, loss: 0.00852270144969225

step: 90, loss: 0.002122774487361312

step: 100, loss: 0.0004004328802693635

step: 110, loss: 0.03200896829366684

step: 120, loss: 0.0003931521496269852

step: 130, loss: 0.0002211129030911252

step: 140, loss: 0.00241507263854146

step: 150, loss: 0.02468414418399334

step: 160, loss: 0.0008942782296799123

step: 170, loss: 0.0010244845179840922

epoch 9: dev_f1=0.8578431372549019, f1=0.884160756501182, best_f1=0.8861985472154963

step: 0, loss: 0.0007975963526405394

step: 10, loss: 0.0005538552068173885

step: 20, loss: 0.03204217925667763

step: 30, loss: 0.010428511537611485

step: 40, loss: 0.03793253377079964

step: 50, loss: 0.00018089056538883597

step: 60, loss: 0.00015028505004011095

step: 70, loss: 0.01023690402507782

step: 80, loss: 0.001637143548578024

step: 90, loss: 0.0001442062930436805

step: 100, loss: 0.0003159776097163558

step: 110, loss: 0.00016827118815854192

step: 120, loss: 0.023147299885749817

step: 130, loss: 0.08660469949245453

step: 140, loss: 0.0027921590954065323

step: 150, loss: 0.007376312743872404

step: 160, loss: 0.004038763232529163

step: 170, loss: 0.0001722618762869388

epoch 10: dev_f1=0.8666666666666666, f1=0.8780487804878048, best_f1=0.8861985472154963

step: 0, loss: 0.0003095806168857962

step: 10, loss: 0.020225264132022858

step: 20, loss: 0.00858230423182249

step: 30, loss: 0.000965556304436177

step: 40, loss: 0.0005039424286223948

step: 50, loss: 0.0005210791132412851

step: 60, loss: 0.0003941364702768624

step: 70, loss: 0.00035809152177535

step: 80, loss: 0.057628996670246124

step: 90, loss: 0.03993859514594078

step: 100, loss: 0.0011576662072911859

step: 110, loss: 0.0013288076734170318

step: 120, loss: 0.0022412145044654608

step: 130, loss: 0.00033862056443467736

step: 140, loss: 0.06390953809022903

step: 150, loss: 0.0008477690280415118

step: 160, loss: 0.00040312614873982966

step: 170, loss: 0.0071531059220433235

epoch 11: dev_f1=0.869158878504673, f1=0.8629213483146069, best_f1=0.8861985472154963

step: 0, loss: 0.0003760693653021008

step: 10, loss: 0.00020468045840971172

step: 20, loss: 0.00037511688424274325

step: 30, loss: 0.0008898575906641781

step: 40, loss: 0.00041357180452905595

step: 50, loss: 0.00012682868691626936

step: 60, loss: 0.030906131491065025

step: 70, loss: 0.0001323303149547428

step: 80, loss: 0.04510137066245079

step: 90, loss: 0.0008007515571080148

step: 100, loss: 8.980929851531982e-05

step: 110, loss: 7.141891546780244e-05

step: 120, loss: 0.0012837203685194254

step: 130, loss: 0.010328003205358982

step: 140, loss: 0.000555418839212507

step: 150, loss: 9.801757551031187e-05

step: 160, loss: 0.0009920236188918352

step: 170, loss: 6.954772106837481e-05

epoch 12: dev_f1=0.860759493670886, f1=0.8668280871670702, best_f1=0.8861985472154963

step: 0, loss: 0.0001890132116386667

step: 10, loss: 0.00013920287892688066

step: 20, loss: 0.0011161310831084847

Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0

step: 30, loss: 0.001394722145050764

step: 40, loss: 0.012939244508743286

step: 50, loss: 0.0001001937998807989

step: 60, loss: 0.027470877394080162

step: 70, loss: 0.0003838567645289004

step: 80, loss: 0.0032760906033217907

step: 90, loss: 0.0009238989441655576

step: 100, loss: 0.039408665150403976

step: 110, loss: 0.0159424040466547

step: 120, loss: 0.014417639002203941

step: 130, loss: 0.0006599854677915573

step: 140, loss: 0.00012007167242700234

step: 150, loss: 0.020399820059537888

step: 160, loss: 0.0008925874135456979

step: 170, loss: 0.00019362129387445748

epoch 13: dev_f1=0.8759493670886076, f1=0.8743961352657006, best_f1=0.8861985472154963

step: 0, loss: 0.0001465351233491674

step: 10, loss: 0.008337019942700863

step: 20, loss: 0.00010373356781201437

step: 30, loss: 0.002280490007251501

step: 40, loss: 0.0001625574950594455

step: 50, loss: 0.00011038975935662165

step: 60, loss: 0.0016892419662326574

step: 70, loss: 0.0007572962203994393

step: 80, loss: 8.512797649018466e-05

step: 90, loss: 0.0002167926577385515

step: 100, loss: 0.00887385942041874

step: 110, loss: 0.00011684576020343229

step: 120, loss: 0.00039788245339877903

step: 130, loss: 5.0263806770090014e-05

step: 140, loss: 0.015190702863037586

step: 150, loss: 0.00014011168968863785

step: 160, loss: 0.048723410815000534

step: 170, loss: 7.151922181947157e-05

epoch 14: dev_f1=0.8672985781990522, f1=0.8456375838926173, best_f1=0.8861985472154963

step: 0, loss: 0.003323337994515896

step: 10, loss: 0.00010785477206809446

step: 20, loss: 8.948041795520112e-05

step: 30, loss: 0.000994754722341895

step: 40, loss: 0.004018610808998346

step: 50, loss: 0.0013536486076191068

step: 60, loss: 0.0333821102976799

step: 70, loss: 0.0005862208781763911

step: 80, loss: 0.00019506074022501707

step: 90, loss: 6.20261489530094e-05

step: 100, loss: 7.328677020268515e-05

step: 110, loss: 0.0050123101100325584

step: 120, loss: 0.001382882590405643

step: 130, loss: 8.660247112857178e-05

step: 140, loss: 0.0003076674183830619

step: 150, loss: 0.00036651635309681296

step: 160, loss: 0.00036177734727971256

step: 170, loss: 0.0007369096274487674

epoch 15: dev_f1=0.8724489795918366, f1=0.8786407766990291, best_f1=0.8861985472154963



























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































0
CUDA_VISIBLE_DEVICES=0 python train_ditto.py               --task Textual/Abt-Buy               --logdir results_ditto/               --finetuning               --batch_size 32               --lr 3e-5               --fp16               --lm roberta               --n_epochs 15               --run_id 2 --da swap --dk general
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.



Defaults for this optimization level are:

enabled                : True

opt_level              : O2

cast_model_type        : torch.float16

patch_torch_functions  : False

keep_batchnorm_fp32    : True

master_weights         : True

loss_scale             : dynamic

Processing user overrides (additional kwargs that are not None)...

After processing overrides, optimization options are:

enabled                : True

opt_level              : O2

cast_model_type        : torch.float16

patch_torch_functions  : False

keep_batchnorm_fp32    : True

master_weights         : True

loss_scale             : dynamic

Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")

Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0

step: 0, loss: 0.6639328598976135

Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0

Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0

step: 10, loss: 0.47733914852142334

step: 20, loss: 0.4444354772567749

step: 30, loss: 0.3725418746471405

step: 40, loss: 0.4925713837146759

step: 50, loss: 0.2112945318222046

step: 60, loss: 0.29307302832603455

step: 70, loss: 0.354718953371048

step: 80, loss: 0.511894702911377

step: 90, loss: 0.41853344440460205

step: 100, loss: 0.5122936367988586

step: 110, loss: 0.21997927129268646

step: 120, loss: 0.24136504530906677

step: 130, loss: 0.35449182987213135

step: 140, loss: 0.18587139248847961

step: 150, loss: 0.18232956528663635

step: 160, loss: 0.49206772446632385

step: 170, loss: 0.3232804536819458

epoch 1: dev_f1=0.1941564561734213, f1=0.1941564561734213, best_f1=0.1941564561734213

step: 0, loss: 0.2505864202976227

step: 10, loss: 0.2600555121898651

step: 20, loss: 0.5089991092681885

step: 30, loss: 0.6084885597229004

step: 40, loss: 0.34999844431877136

step: 50, loss: 0.22954779863357544

step: 60, loss: 0.32634174823760986

step: 70, loss: 0.27258962392807007

step: 80, loss: 0.1821204423904419

step: 90, loss: 0.14649391174316406

step: 100, loss: 0.19123303890228271

step: 110, loss: 0.26838696002960205

step: 120, loss: 0.11855454742908478

step: 130, loss: 0.14058314263820648

step: 140, loss: 0.24017658829689026

step: 150, loss: 0.06611572206020355

step: 160, loss: 0.3880327045917511

step: 170, loss: 0.2142346352338791

epoch 2: dev_f1=0.7310344827586207, f1=0.7252252252252251, best_f1=0.7252252252252251

step: 0, loss: 0.09665742516517639

step: 10, loss: 0.15287216007709503

step: 20, loss: 0.029610399156808853

step: 30, loss: 0.18605788052082062

step: 40, loss: 0.0843035876750946

step: 50, loss: 0.017081547528505325

step: 60, loss: 0.10084355622529984

step: 70, loss: 0.14609502255916595

step: 80, loss: 0.03896724432706833

step: 90, loss: 0.23338618874549866

step: 100, loss: 0.15649347007274628

step: 110, loss: 0.1417180746793747

step: 120, loss: 0.061874303966760635

step: 130, loss: 0.1259729564189911

step: 140, loss: 0.14446204900741577

step: 150, loss: 0.031904399394989014

step: 160, loss: 0.12854057550430298

step: 170, loss: 0.05026344209909439

epoch 3: dev_f1=0.8205128205128205, f1=0.8170426065162907, best_f1=0.8170426065162907

step: 0, loss: 0.0847758874297142

step: 10, loss: 0.1477186381816864

step: 20, loss: 0.16405732929706573

step: 30, loss: 0.13565416634082794

step: 40, loss: 0.014331894926726818

step: 50, loss: 0.07713973522186279

step: 60, loss: 0.08027549088001251

step: 70, loss: 0.20594027638435364

step: 80, loss: 0.0048074680380523205

step: 90, loss: 0.2253132313489914

step: 100, loss: 0.08446168899536133

step: 110, loss: 0.16556236147880554

step: 120, loss: 0.14454901218414307

step: 130, loss: 0.004072603303939104

step: 140, loss: 0.07775364816188812

step: 150, loss: 0.03367894887924194

step: 160, loss: 0.15560099482536316

step: 170, loss: 0.10701240599155426

epoch 4: dev_f1=0.8584905660377358, f1=0.8658823529411764, best_f1=0.8658823529411764

step: 0, loss: 0.04504675790667534

step: 10, loss: 0.11013821512460709

step: 20, loss: 0.0060232849791646

step: 30, loss: 0.00797929335385561

step: 40, loss: 0.03744836151599884

step: 50, loss: 0.059815872460603714

step: 60, loss: 0.11112866550683975

step: 70, loss: 0.054379917681217194

step: 80, loss: 0.0258669201284647

step: 90, loss: 0.012782013975083828

step: 100, loss: 0.0024268068373203278

step: 110, loss: 0.07198815047740936

step: 120, loss: 0.02112175151705742

step: 130, loss: 0.15051542222499847

step: 140, loss: 0.04756807163357735

step: 150, loss: 0.06379125267267227

step: 160, loss: 0.09873942285776138

step: 170, loss: 0.12281469255685806

epoch 5: dev_f1=0.85781990521327, f1=0.8798076923076924, best_f1=0.8658823529411764

step: 0, loss: 0.011886139400303364

step: 10, loss: 0.07695426046848297

step: 20, loss: 0.031500741839408875

step: 30, loss: 0.004627385642379522

step: 40, loss: 0.019792664796113968

step: 50, loss: 0.006567016243934631

step: 60, loss: 0.01987169310450554

step: 70, loss: 0.06982278823852539

step: 80, loss: 0.10873223841190338

step: 90, loss: 0.0014905279967933893

step: 100, loss: 0.008623502217233181

step: 110, loss: 0.054829973727464676

step: 120, loss: 0.003524495754390955

step: 130, loss: 0.07611240446567535

step: 140, loss: 0.09527803957462311

step: 150, loss: 0.17423349618911743

step: 160, loss: 0.011817033402621746

step: 170, loss: 0.0010162460384890437

epoch 6: dev_f1=0.8719211822660098, f1=0.8861985472154963, best_f1=0.8861985472154963

step: 0, loss: 0.016594165936112404

step: 10, loss: 0.03006516955792904

step: 20, loss: 0.004010445438325405

step: 30, loss: 0.008016034960746765

step: 40, loss: 0.0001726174814393744

step: 50, loss: 0.0014439087826758623

step: 60, loss: 0.00035309488885104656

step: 70, loss: 0.0005447963485494256

step: 80, loss: 0.002817849861457944

step: 90, loss: 0.05170141160488129

step: 100, loss: 0.002206303644925356

step: 110, loss: 0.22173652052879333

step: 120, loss: 0.0032116512302309275

step: 130, loss: 0.056804731488227844

step: 140, loss: 0.13531823456287384

step: 150, loss: 0.11372240632772446

step: 160, loss: 0.0015174958389252424

step: 170, loss: 0.024245962500572205

epoch 7: dev_f1=0.8861985472154963, f1=0.9060240963855423, best_f1=0.9060240963855423

step: 0, loss: 0.000621630868408829

step: 10, loss: 0.0011908229207620025

step: 20, loss: 0.0002665189967956394

step: 30, loss: 0.015329777263104916

step: 40, loss: 0.0023473864421248436

step: 50, loss: 0.03642343357205391

step: 60, loss: 0.01780511811375618

step: 70, loss: 0.00027618883177638054

step: 80, loss: 0.27393049001693726

step: 90, loss: 0.06694880872964859

step: 100, loss: 0.001454610493965447

step: 110, loss: 0.008633406832814217

step: 120, loss: 0.0010561201488599181

step: 130, loss: 0.09977412223815918

step: 140, loss: 0.002002221532166004

step: 150, loss: 0.02454490028321743

step: 160, loss: 0.0012617059983313084

step: 170, loss: 0.0003953400591854006

epoch 8: dev_f1=0.8695652173913043, f1=0.8793969849246231, best_f1=0.9060240963855423

step: 0, loss: 0.03477700427174568

step: 10, loss: 0.0034054641146212816

step: 20, loss: 0.0011660053860396147

step: 30, loss: 0.0032031105365604162

step: 40, loss: 0.01618262566626072

step: 50, loss: 0.004335629288107157

step: 60, loss: 0.0939859077334404

step: 70, loss: 0.0003727106377482414

step: 80, loss: 0.0006675770273432136

step: 90, loss: 0.003667305689305067

step: 100, loss: 0.0011784657835960388

step: 110, loss: 0.001256042392924428

step: 120, loss: 0.010709300637245178

step: 130, loss: 0.17353491485118866

step: 140, loss: 0.05168398842215538

step: 150, loss: 0.0007840340840630233

step: 160, loss: 0.0009537794976495206

step: 170, loss: 0.0009143337956629694

epoch 9: dev_f1=0.8713910761154857, f1=0.8622448979591837, best_f1=0.9060240963855423

step: 0, loss: 0.0005956112872809172

step: 10, loss: 0.007003876380622387

step: 20, loss: 0.0029734347481280565

step: 30, loss: 0.007643730379641056

step: 40, loss: 0.0030089442152529955

step: 50, loss: 0.0034602531231939793

step: 60, loss: 0.007934543304145336

step: 70, loss: 0.02080545760691166

step: 80, loss: 0.020955847576260567

step: 90, loss: 0.025962160900235176

step: 100, loss: 0.00837746262550354

step: 110, loss: 0.012423879466950893

step: 120, loss: 0.032465118914842606

step: 130, loss: 0.00039095652755349874

step: 140, loss: 0.001320420764386654

step: 150, loss: 0.004503007046878338

step: 160, loss: 0.00037707487354055047

step: 170, loss: 0.015522808767855167

epoch 10: dev_f1=0.8444444444444444, f1=0.8697788697788698, best_f1=0.9060240963855423

step: 0, loss: 0.010532254353165627

step: 10, loss: 0.005390888545662165

step: 20, loss: 0.016775276511907578

step: 30, loss: 0.0019358135759830475

step: 40, loss: 0.006062638014554977

step: 50, loss: 0.003277549287304282

step: 60, loss: 0.010140160098671913

step: 70, loss: 0.003992494661360979

step: 80, loss: 0.0022745048627257347

step: 90, loss: 0.005194995552301407

step: 100, loss: 0.00033108380739577115

step: 110, loss: 0.00023170791973825544

step: 120, loss: 0.0012505140621215105

step: 130, loss: 0.02648419514298439

step: 140, loss: 0.004028404597193003

step: 150, loss: 0.005594197660684586

step: 160, loss: 0.01103866659104824

step: 170, loss: 0.026234056800603867

epoch 11: dev_f1=0.8671679197994987, f1=0.8753056234718827, best_f1=0.9060240963855423

step: 0, loss: 0.0004009532858617604

step: 10, loss: 0.02348419651389122

step: 20, loss: 0.019418269395828247

step: 30, loss: 0.052235957235097885

step: 40, loss: 0.015176803804934025

step: 50, loss: 0.009422114118933678

step: 60, loss: 0.0011945421574637294

step: 70, loss: 0.014541126787662506

step: 80, loss: 0.054489899426698685

step: 90, loss: 0.008193239569664001

step: 100, loss: 0.003824750194326043

step: 110, loss: 0.007663475815206766

step: 120, loss: 0.002407434629276395

step: 130, loss: 0.00013406947255134583

step: 140, loss: 0.0002943667641375214

step: 150, loss: 0.0024416805244982243

step: 160, loss: 0.0657658651471138

step: 170, loss: 0.005636310204863548

epoch 12: dev_f1=0.8671679197994987, f1=0.8753056234718827, best_f1=0.9060240963855423

step: 0, loss: 0.0073501975275576115

step: 10, loss: 0.03861303627490997

step: 20, loss: 9.168763790512457e-05

step: 30, loss: 0.0020055484492331743

step: 40, loss: 0.0023327593225985765

step: 50, loss: 0.002954957541078329

step: 60, loss: 0.07644960284233093

step: 70, loss: 0.0002817578206304461

step: 80, loss: 0.005419014021754265

step: 90, loss: 0.00012352624617051333

step: 100, loss: 0.00017994706286117435

step: 110, loss: 7.631685730302706e-05

step: 120, loss: 7.717229891568422e-05

step: 130, loss: 0.00010814182314788923

step: 140, loss: 0.00019457077723927796

step: 150, loss: 3.342260970384814e-05

step: 160, loss: 0.01901455596089363

step: 170, loss: 9.047995263244957e-05

epoch 13: dev_f1=0.8702290076335877, f1=0.8784119106699751, best_f1=0.9060240963855423

step: 0, loss: 6.46052067168057e-05

step: 10, loss: 5.0098900828743353e-05

step: 20, loss: 0.0014698912855237722

step: 30, loss: 9.774544014362618e-05

step: 40, loss: 4.2273011786164716e-05

step: 50, loss: 3.340388138894923e-05

step: 60, loss: 0.0875966027379036

step: 70, loss: 5.3784930059919134e-05

step: 80, loss: 0.0008728430257178843

step: 90, loss: 0.0035857283510267735

step: 100, loss: 4.528187491814606e-05

step: 110, loss: 4.629603063222021e-05

step: 120, loss: 0.00876044575124979

step: 130, loss: 0.00010377435683039948

step: 140, loss: 4.722817175206728e-05

step: 150, loss: 0.022659704089164734

step: 160, loss: 0.011833766475319862

step: 170, loss: 0.0005046601872891188

epoch 14: dev_f1=0.8734491315136476, f1=0.883495145631068, best_f1=0.9060240963855423

step: 0, loss: 0.00045929179759696126

step: 10, loss: 6.249432772165164e-05

step: 20, loss: 0.0001382912159897387

step: 30, loss: 8.998220437206328e-05

step: 40, loss: 0.15197360515594482

step: 50, loss: 0.010611599311232567

step: 60, loss: 0.0020212330855429173

step: 70, loss: 7.176098733907565e-05

step: 80, loss: 0.00017706507060211152

step: 90, loss: 3.932270556106232e-05

step: 100, loss: 6.79987424518913e-05

step: 110, loss: 0.00022579818323720247

step: 120, loss: 0.02667998895049095

step: 130, loss: 0.0001518885837867856

step: 140, loss: 0.0008288183016702533

step: 150, loss: 0.0046311356127262115

step: 160, loss: 0.0040825968608260155

step: 170, loss: 7.351460953941569e-05

epoch 15: dev_f1=0.8756218905472637, f1=0.88135593220339, best_f1=0.9060240963855423











































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































0
CUDA_VISIBLE_DEVICES=0 python train_ditto.py               --task Textual/Abt-Buy               --logdir results_ditto/               --finetuning               --batch_size 32               --lr 3e-5               --fp16               --lm roberta               --n_epochs 15               --run_id 3 --da swap --dk general
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.



Defaults for this optimization level are:

enabled                : True

opt_level              : O2

cast_model_type        : torch.float16

patch_torch_functions  : False

keep_batchnorm_fp32    : True

master_weights         : True

loss_scale             : dynamic

Processing user overrides (additional kwargs that are not None)...

After processing overrides, optimization options are:

enabled                : True

opt_level              : O2

cast_model_type        : torch.float16

patch_torch_functions  : False

keep_batchnorm_fp32    : True

master_weights         : True

loss_scale             : dynamic

Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")

Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0

step: 0, loss: 0.6033064126968384

Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0

Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0

step: 10, loss: 0.2660754323005676

step: 20, loss: 0.45863738656044006

step: 30, loss: 0.3129299581050873

step: 40, loss: 0.3751164376735687

step: 50, loss: 0.17865265905857086

step: 60, loss: 0.3489426374435425

step: 70, loss: 0.4489678144454956

step: 80, loss: 0.6521482467651367

step: 90, loss: 0.32544708251953125

step: 100, loss: 0.3915259540081024

step: 110, loss: 0.4584365487098694

step: 120, loss: 0.5088728666305542

step: 130, loss: 0.37749677896499634

step: 140, loss: 0.240589439868927

step: 150, loss: 0.311160147190094

step: 160, loss: 0.5362398624420166

step: 170, loss: 0.5875530242919922

epoch 1: dev_f1=0.1941564561734213, f1=0.1941564561734213, best_f1=0.1941564561734213

step: 0, loss: 0.338101327419281

step: 10, loss: 0.27040770649909973

step: 20, loss: 0.10934306681156158

step: 30, loss: 0.2277350127696991

step: 40, loss: 0.4299483895301819

step: 50, loss: 0.36338382959365845

step: 60, loss: 0.3011974096298218

step: 70, loss: 0.31337666511535645

step: 80, loss: 0.2989734709262848

step: 90, loss: 0.4065668284893036

step: 100, loss: 0.35446131229400635

step: 110, loss: 0.3228766620159149

step: 120, loss: 0.46510621905326843

step: 130, loss: 0.3117322623729706

step: 140, loss: 0.18712013959884644

step: 150, loss: 0.3596389591693878

step: 160, loss: 0.3051840662956238

step: 170, loss: 0.3095180094242096

epoch 2: dev_f1=0.1941564561734213, f1=0.1941564561734213, best_f1=0.1941564561734213

step: 0, loss: 0.11361947655677795

step: 10, loss: 0.5674984455108643

step: 20, loss: 0.22754250466823578

step: 30, loss: 0.21858033537864685

step: 40, loss: 0.21825480461120605

step: 50, loss: 0.3696165084838867

step: 60, loss: 0.17092309892177582

step: 70, loss: 0.3162061870098114

step: 80, loss: 0.4212188720703125

step: 90, loss: 0.44907230138778687

step: 100, loss: 0.3358640670776367

step: 110, loss: 0.3606935441493988

step: 120, loss: 0.3276371359825134

step: 130, loss: 0.24597254395484924

step: 140, loss: 0.41464078426361084

step: 150, loss: 0.2336166799068451

step: 160, loss: 0.43472954630851746

step: 170, loss: 0.3195120692253113

epoch 3: dev_f1=0.4896907216494846, f1=0.3881401617250674, best_f1=0.3881401617250674

step: 0, loss: 0.34610623121261597

step: 10, loss: 0.12120939791202545

step: 20, loss: 0.28005167841911316

step: 30, loss: 0.2785954177379608

step: 40, loss: 0.25090187788009644

step: 50, loss: 0.20183587074279785

step: 60, loss: 0.3427170515060425

step: 70, loss: 0.25380343198776245

step: 80, loss: 0.3108895421028137

step: 90, loss: 0.2731476426124573

step: 100, loss: 0.3636123239994049

step: 110, loss: 0.22600330412387848

step: 120, loss: 0.28072628378868103

step: 130, loss: 0.254768967628479

step: 140, loss: 0.3383464813232422

step: 150, loss: 0.5052275657653809

step: 160, loss: 0.1106385886669159

step: 170, loss: 0.14369834959506989

epoch 4: dev_f1=0.6340425531914895, f1=0.6396588486140725, best_f1=0.6396588486140725

step: 0, loss: 0.2132459580898285

step: 10, loss: 0.14376847445964813

step: 20, loss: 0.2994222342967987

step: 30, loss: 0.2152191400527954

step: 40, loss: 0.2957552373409271

step: 50, loss: 0.20147624611854553

step: 60, loss: 0.2204132378101349

step: 70, loss: 0.06358890235424042

step: 80, loss: 0.14453373849391937

step: 90, loss: 0.10459646582603455

step: 100, loss: 0.10363927483558655

step: 110, loss: 0.08684727549552917

step: 120, loss: 0.1348654180765152

step: 130, loss: 0.22052863240242004

step: 140, loss: 0.3103761672973633

step: 150, loss: 0.16580337285995483

step: 160, loss: 0.3744473159313202

step: 170, loss: 0.23920506238937378

epoch 5: dev_f1=0.47757255936675463, f1=0.46875000000000006, best_f1=0.6396588486140725

step: 0, loss: 0.19237279891967773

step: 10, loss: 0.25760477781295776

step: 20, loss: 0.15618203580379486

step: 30, loss: 0.4555443227291107

step: 40, loss: 0.13446763157844543

step: 50, loss: 0.3108218312263489

step: 60, loss: 0.13266682624816895

step: 70, loss: 0.1404474526643753

step: 80, loss: 0.13840313255786896

step: 90, loss: 0.0735740140080452

step: 100, loss: 0.07805704325437546

step: 110, loss: 0.13481664657592773

step: 120, loss: 0.2742014527320862

step: 130, loss: 0.36119797825813293

step: 140, loss: 0.07968158274888992

step: 150, loss: 0.08636543154716492

step: 160, loss: 0.11266987770795822

step: 170, loss: 0.17715995013713837

epoch 6: dev_f1=0.6652977412731007, f1=0.6639511201629329, best_f1=0.6639511201629329

step: 0, loss: 0.22993677854537964

step: 10, loss: 0.08281785994768143

step: 20, loss: 0.10143305361270905

step: 30, loss: 0.18331722915172577

step: 40, loss: 0.3048762381076813

step: 50, loss: 0.07388364523649216

step: 60, loss: 0.22341865301132202

step: 70, loss: 0.1570778489112854

step: 80, loss: 0.08098360896110535

step: 90, loss: 0.12103712558746338

step: 100, loss: 0.1506289541721344

step: 110, loss: 0.12259572744369507

step: 120, loss: 0.044580139219760895

step: 130, loss: 0.14707311987876892

step: 140, loss: 0.08526020497083664

step: 150, loss: 0.1268441379070282

step: 160, loss: 0.056510474532842636

step: 170, loss: 0.06720398366451263

epoch 7: dev_f1=0.6787878787878787, f1=0.6679920477137177, best_f1=0.6679920477137177

step: 0, loss: 0.14393359422683716

step: 10, loss: 0.09564489126205444

step: 20, loss: 0.20332446694374084

step: 30, loss: 0.10046730935573578

step: 40, loss: 0.11611481755971909

step: 50, loss: 0.09958519786596298

step: 60, loss: 0.07437781989574432

step: 70, loss: 0.024124788120388985

step: 80, loss: 0.21995313465595245

step: 90, loss: 0.23654259741306305

step: 100, loss: 0.16254602372646332

step: 110, loss: 0.14489784836769104

step: 120, loss: 0.07819259911775589

step: 130, loss: 0.3371502161026001

step: 140, loss: 0.06907343119382858

step: 150, loss: 0.23164302110671997

step: 160, loss: 0.19313064217567444

step: 170, loss: 0.0655646100640297

epoch 8: dev_f1=0.7072599531615924, f1=0.7227272727272728, best_f1=0.7227272727272728

step: 0, loss: 0.11278531700372696

step: 10, loss: 0.21845035254955292

step: 20, loss: 0.10653416067361832

step: 30, loss: 0.295888751745224

step: 40, loss: 0.03164432570338249

step: 50, loss: 0.08136952668428421

step: 60, loss: 0.06646774709224701

step: 70, loss: 0.1087430790066719

step: 80, loss: 0.06756861507892609

step: 90, loss: 0.12359665334224701

step: 100, loss: 0.06317685544490814

step: 110, loss: 0.08532712608575821

step: 120, loss: 0.18610578775405884

step: 130, loss: 0.009763078764081001

step: 140, loss: 0.03268451616168022

step: 150, loss: 0.11395725607872009

step: 160, loss: 0.058613210916519165

step: 170, loss: 0.14351287484169006

epoch 9: dev_f1=0.7425742574257427, f1=0.7673860911270983, best_f1=0.7673860911270983

step: 0, loss: 0.04262835532426834

step: 10, loss: 0.15803299844264984

step: 20, loss: 0.058898068964481354

step: 30, loss: 0.030978994444012642

step: 40, loss: 0.08299766480922699

step: 50, loss: 0.0912812128663063

step: 60, loss: 0.020687362179160118

step: 70, loss: 0.07261097431182861

step: 80, loss: 0.03729208558797836

step: 90, loss: 0.1541341245174408

step: 100, loss: 0.022819073870778084

step: 110, loss: 0.13950058817863464

step: 120, loss: 0.04946119338274002

step: 130, loss: 0.12899340689182281

step: 140, loss: 0.21318747103214264

step: 150, loss: 0.3585551083087921

step: 160, loss: 0.12818680703639984

step: 170, loss: 0.11235583573579788

epoch 10: dev_f1=0.75, f1=0.7659574468085106, best_f1=0.7659574468085106

step: 0, loss: 0.08061854541301727

step: 10, loss: 0.10241159796714783

step: 20, loss: 0.17077705264091492

step: 30, loss: 0.022633034735918045

step: 40, loss: 0.2957260012626648

step: 50, loss: 0.10648587346076965

step: 60, loss: 0.016204796731472015

step: 70, loss: 0.11569666862487793

step: 80, loss: 0.12367494404315948

step: 90, loss: 0.15236400067806244

step: 100, loss: 0.052779436111450195

step: 110, loss: 0.11622589081525803

step: 120, loss: 0.06271114945411682

step: 130, loss: 0.044964879751205444

step: 140, loss: 0.058788642287254333

step: 150, loss: 0.01969122514128685

step: 160, loss: 0.03546657785773277

step: 170, loss: 0.10503543168306351

epoch 11: dev_f1=0.7744874715261958, f1=0.7777777777777778, best_f1=0.7777777777777778

step: 0, loss: 0.1379869133234024

step: 10, loss: 0.0492844432592392

step: 20, loss: 0.026346011087298393

step: 30, loss: 0.011717816814780235

step: 40, loss: 0.09593396633863449

step: 50, loss: 0.11064676940441132

step: 60, loss: 0.08171719312667847

step: 70, loss: 0.1129489541053772

step: 80, loss: 0.01869109272956848

step: 90, loss: 0.04723459109663963

step: 100, loss: 0.08663853257894516

step: 110, loss: 0.046186499297618866

step: 120, loss: 0.08323931694030762

step: 130, loss: 0.04294680058956146

step: 140, loss: 0.0008100533741526306

step: 150, loss: 0.05555475503206253

step: 160, loss: 0.13199582695960999

step: 170, loss: 0.09452217072248459

epoch 12: dev_f1=0.7777777777777778, f1=0.7973568281938326, best_f1=0.7973568281938326

step: 0, loss: 0.035159241408109665

step: 10, loss: 0.13096009194850922

step: 20, loss: 0.014064822345972061

step: 30, loss: 0.051348887383937836

step: 40, loss: 0.07891852408647537

step: 50, loss: 0.2824800908565521

step: 60, loss: 0.04733996465802193

step: 70, loss: 0.06956087052822113

step: 80, loss: 0.04114648699760437

step: 90, loss: 0.007707966025918722

step: 100, loss: 0.08552522212266922

step: 110, loss: 0.020613733679056168

step: 120, loss: 0.004164688754826784

step: 130, loss: 0.022656071931123734

step: 140, loss: 0.01119035854935646

step: 150, loss: 0.05187143012881279

step: 160, loss: 0.04958203062415123

step: 170, loss: 0.09317724406719208

epoch 13: dev_f1=0.7844036697247706, f1=0.8026607538802661, best_f1=0.8026607538802661

step: 0, loss: 0.04676973819732666

step: 10, loss: 0.12764906883239746

step: 20, loss: 0.005848555825650692

step: 30, loss: 0.028545910492539406

step: 40, loss: 0.09690296649932861

step: 50, loss: 0.12011978775262833

step: 60, loss: 0.04153873771429062

step: 70, loss: 0.017420679330825806

step: 80, loss: 0.020039167255163193

step: 90, loss: 0.06736093759536743

step: 100, loss: 0.10958734154701233

step: 110, loss: 0.01227003987878561

step: 120, loss: 0.03391729295253754

step: 130, loss: 0.01840030960738659

step: 140, loss: 0.006696923170238733

step: 150, loss: 0.03429708629846573

step: 160, loss: 0.07807723432779312

step: 170, loss: 0.09207399189472198

epoch 14: dev_f1=0.7783251231527093, f1=0.8074245939675173, best_f1=0.8026607538802661

step: 0, loss: 0.0712498128414154

step: 10, loss: 0.04774748533964157

step: 20, loss: 0.013482702895998955

step: 30, loss: 0.13158676028251648

step: 40, loss: 0.1114397943019867

step: 50, loss: 0.012708596885204315

step: 60, loss: 0.01696722023189068

step: 70, loss: 0.0887371301651001

step: 80, loss: 0.046901457011699677

step: 90, loss: 0.012226001359522343

step: 100, loss: 0.015601908788084984

step: 110, loss: 0.030692532658576965

step: 120, loss: 0.037183646112680435

step: 130, loss: 0.11203596740961075

step: 140, loss: 0.0957646444439888

step: 150, loss: 0.01015788596123457

step: 160, loss: 0.07071848958730698

step: 170, loss: 0.005122133065015078

epoch 15: dev_f1=0.7919799498746868, f1=0.8132387706855791, best_f1=0.8132387706855791



































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































0
CUDA_VISIBLE_DEVICES=0 python train_ditto.py               --task Textual/Abt-Buy               --logdir results_ditto/               --finetuning               --batch_size 32               --lr 3e-5               --fp16               --lm roberta               --n_epochs 15               --run_id 4 --da swap --dk general
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.



Defaults for this optimization level are:

enabled                : True

opt_level              : O2

cast_model_type        : torch.float16

patch_torch_functions  : False

keep_batchnorm_fp32    : True

master_weights         : True

loss_scale             : dynamic

Processing user overrides (additional kwargs that are not None)...

After processing overrides, optimization options are:

enabled                : True

opt_level              : O2

cast_model_type        : torch.float16

patch_torch_functions  : False

keep_batchnorm_fp32    : True

master_weights         : True

loss_scale             : dynamic

Warning:  multi_tensor_applier fused unscale kernel is unavailable, possibly because apex was installed without --cuda_ext --cpp_ext. Using Python fallback.  Original ImportError was: ModuleNotFoundError("No module named 'amp_C'")

Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0

step: 0, loss: 0.5382093787193298

Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0

step: 10, loss: 0.24094276130199432

step: 20, loss: 0.2650030553340912

step: 30, loss: 0.30162113904953003

step: 40, loss: 0.16495881974697113

step: 50, loss: 0.4235652685165405

step: 60, loss: 0.2671564519405365

step: 70, loss: 0.41589096188545227

step: 80, loss: 0.22465406358242035

step: 90, loss: 0.255803644657135

step: 100, loss: 0.45615220069885254

step: 110, loss: 0.2997676730155945

step: 120, loss: 0.3023049533367157

step: 130, loss: 0.21499894559383392

step: 140, loss: 0.21773871779441833

step: 150, loss: 0.2806908190250397

step: 160, loss: 0.1971440315246582

step: 170, loss: 0.056245867162942886

epoch 1: dev_f1=0.7204301075268817, f1=0.7253333333333333, best_f1=0.7253333333333333

step: 0, loss: 0.19595839083194733

step: 10, loss: 0.104261115193367

step: 20, loss: 0.11765848100185394

step: 30, loss: 0.11450030654668808

step: 40, loss: 0.08008752763271332

step: 50, loss: 0.10336356610059738

step: 60, loss: 0.07982458174228668

step: 70, loss: 0.26937228441238403

step: 80, loss: 0.13568052649497986

step: 90, loss: 0.17445698380470276

step: 100, loss: 0.053135741502046585

step: 110, loss: 0.10623471438884735

step: 120, loss: 0.06972317397594452

step: 130, loss: 0.22666653990745544

step: 140, loss: 0.1613980531692505

step: 150, loss: 0.4599250853061676

step: 160, loss: 0.030246887356042862

step: 170, loss: 0.25431567430496216

epoch 2: dev_f1=0.8530120481927711, f1=0.8847058823529411, best_f1=0.8847058823529411

step: 0, loss: 0.06861721724271774

step: 10, loss: 0.05879716947674751

step: 20, loss: 0.028714526444673538

step: 30, loss: 0.004433335270732641

step: 40, loss: 0.19972796738147736

step: 50, loss: 0.13739895820617676

step: 60, loss: 0.009881483390927315

step: 70, loss: 0.057305708527565

step: 80, loss: 0.08609683811664581

step: 90, loss: 0.019596869125962257

step: 100, loss: 0.03952547907829285

step: 110, loss: 0.1378505527973175

step: 120, loss: 0.03910861164331436

step: 130, loss: 0.01492168940603733

step: 140, loss: 0.09264126420021057

step: 150, loss: 0.010210487991571426

step: 160, loss: 0.05921320989727974

step: 170, loss: 0.0090342340990901

epoch 3: dev_f1=0.86, f1=0.8947368421052632, best_f1=0.8947368421052632

step: 0, loss: 0.1267879605293274

step: 10, loss: 0.016364334151148796

step: 20, loss: 0.011989673599600792

step: 30, loss: 0.0011855706106871367

step: 40, loss: 0.002750168088823557

step: 50, loss: 0.02240121364593506

step: 60, loss: 0.03386751562356949

step: 70, loss: 0.21232512593269348

step: 80, loss: 0.1261834353208542

step: 90, loss: 0.010225125588476658

step: 100, loss: 0.0007333191460929811

step: 110, loss: 0.011531048454344273

step: 120, loss: 0.04865555465221405

step: 130, loss: 0.17752261459827423

step: 140, loss: 0.06411059200763702

step: 150, loss: 0.008226754143834114

step: 160, loss: 0.041033245623111725

step: 170, loss: 0.1311441957950592

epoch 4: dev_f1=0.8894472361809046, f1=0.8985507246376813, best_f1=0.8985507246376813

step: 0, loss: 0.009299998171627522

step: 10, loss: 0.0290397759526968

step: 20, loss: 0.0018555192509666085

step: 30, loss: 0.0006468640058301389

step: 40, loss: 0.007353675551712513

step: 50, loss: 0.020733123645186424

step: 60, loss: 0.049920957535505295

step: 70, loss: 0.007803953718394041

step: 80, loss: 0.0017259923042729497

step: 90, loss: 0.024645674973726273

step: 100, loss: 0.006068834103643894

step: 110, loss: 0.0015574570279568434

step: 120, loss: 0.05161646753549576

step: 130, loss: 0.04534541442990303

step: 140, loss: 0.043794263154268265

step: 150, loss: 0.020884189754724503

step: 160, loss: 0.010515227913856506

step: 170, loss: 0.027184685692191124

epoch 5: dev_f1=0.9068627450980392, f1=0.8689320388349513, best_f1=0.8689320388349513

step: 0, loss: 0.06478050351142883

step: 10, loss: 0.02117670327425003

step: 20, loss: 0.0053988550789654255

step: 30, loss: 0.00041812905692495406

step: 40, loss: 0.00023098985548131168

step: 50, loss: 0.0003102793707512319

step: 60, loss: 0.00479945307597518

step: 70, loss: 0.010388811118900776

step: 80, loss: 0.012435099110007286

step: 90, loss: 0.002674299292266369

step: 100, loss: 0.001326628727838397

step: 110, loss: 0.022070515900850296

step: 120, loss: 0.015785623341798782

step: 130, loss: 0.09695103019475937

step: 140, loss: 0.00565372034907341

step: 150, loss: 0.0288546159863472

step: 160, loss: 0.04456240311264992

step: 170, loss: 0.021054893732070923

epoch 6: dev_f1=0.8956743002544529, f1=0.9054726368159205, best_f1=0.8689320388349513

step: 0, loss: 0.05467824637889862

step: 10, loss: 0.0028287640307098627

step: 20, loss: 0.07210167497396469

step: 30, loss: 0.00045593551476486027

step: 40, loss: 0.0006152307614684105

step: 50, loss: 0.039152201265096664

step: 60, loss: 0.0014087577583268285

step: 70, loss: 0.016905155032873154

step: 80, loss: 0.005842560436576605

Gradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0

step: 90, loss: 0.06138531118631363

step: 100, loss: 0.07149544358253479

step: 110, loss: 0.0006850854842923582

step: 120, loss: 0.001017233938910067

step: 130, loss: 0.012363971211016178

step: 140, loss: 0.005043115932494402

step: 150, loss: 0.0029165749438107014

step: 160, loss: 0.008263587951660156

step: 170, loss: 0.09791848808526993

epoch 7: dev_f1=0.902061855670103, f1=0.9040404040404041, best_f1=0.8689320388349513

step: 0, loss: 0.020559940487146378

step: 10, loss: 0.005308248568326235

step: 20, loss: 0.0011987665202468634

step: 30, loss: 0.0009522103937342763

step: 40, loss: 0.09801951050758362

step: 50, loss: 0.0003208205453120172

step: 60, loss: 0.007708713877946138

step: 70, loss: 0.015135579742491245

step: 80, loss: 0.01956077478826046

step: 90, loss: 0.00010701054270612076

step: 100, loss: 0.009137686342000961

step: 110, loss: 0.012342303991317749

step: 120, loss: 0.0022179842926561832

step: 130, loss: 0.0014747069217264652

step: 140, loss: 0.0004380370955914259

step: 150, loss: 0.004901774227619171

step: 160, loss: 0.00018806415027938783

step: 170, loss: 0.0036225866060703993

epoch 8: dev_f1=0.9076923076923077, f1=0.898477157360406, best_f1=0.898477157360406

step: 0, loss: 0.016506345942616463

step: 10, loss: 0.00018474514945410192

step: 20, loss: 0.0008209152729250491

step: 30, loss: 0.010791213251650333

step: 40, loss: 0.0002780889917630702

step: 50, loss: 0.005167422350496054

step: 60, loss: 0.008087675087153912

step: 70, loss: 0.0008604816976003349

step: 80, loss: 8.84980836417526e-05

step: 90, loss: 0.0002301411295775324

step: 100, loss: 6.907403439981863e-05

step: 110, loss: 0.05933236703276634

step: 120, loss: 0.00023168328334577382

step: 130, loss: 0.029981601983308792

step: 140, loss: 0.046810708940029144

step: 150, loss: 0.008210326544940472

step: 160, loss: 0.00711170444265008

step: 170, loss: 9.484105976298451e-05

epoch 9: dev_f1=0.8905472636815919, f1=0.8937198067632851, best_f1=0.898477157360406

step: 0, loss: 0.019560685381293297

step: 10, loss: 0.000421345786890015

step: 20, loss: 0.030286140739917755

step: 30, loss: 0.0034817694686353207

step: 40, loss: 0.0013996640918776393

step: 50, loss: 0.0013137809000909328

step: 60, loss: 0.0005287070525810122

step: 70, loss: 0.002586528193205595

step: 80, loss: 0.0008260297472588718

step: 90, loss: 0.030622726306319237

step: 100, loss: 0.008580107241868973

step: 110, loss: 0.01196525152772665

step: 120, loss: 0.002343946835026145

step: 130, loss: 0.003411566372960806

step: 140, loss: 0.00041032343870028853

step: 150, loss: 0.0003313196648377925

step: 160, loss: 0.13617321848869324

step: 170, loss: 0.0015988964587450027

epoch 10: dev_f1=0.9077306733167083, f1=0.8883495145631068, best_f1=0.8883495145631068

step: 0, loss: 0.02221996895968914

step: 10, loss: 0.0018124016933143139

step: 20, loss: 0.001371194375678897

step: 30, loss: 0.0034650040324777365

step: 40, loss: 0.0001677768159424886

step: 50, loss: 0.00035292276879772544

step: 60, loss: 0.0849205031991005

step: 70, loss: 5.5731230531819165e-05

step: 80, loss: 0.0015345698921009898

step: 90, loss: 0.00019653166236821562

step: 100, loss: 0.0027413619682192802

step: 110, loss: 0.0017135597299784422

step: 120, loss: 0.002025255234912038

step: 130, loss: 0.002539623761549592

step: 140, loss: 0.004778469912707806

step: 150, loss: 0.00457319850102067

step: 160, loss: 0.00033696898026391864

step: 170, loss: 0.004372819326817989

epoch 11: dev_f1=0.900497512437811, f1=0.8888888888888888, best_f1=0.8883495145631068

step: 0, loss: 0.00016930457786656916

step: 10, loss: 0.003350179875269532

step: 20, loss: 0.00018237100448459387

step: 30, loss: 0.0057559930719435215

step: 40, loss: 5.765222886111587e-05

step: 50, loss: 0.00016907829558476806

step: 60, loss: 0.00029671122319996357

step: 70, loss: 0.0026994822546839714

step: 80, loss: 0.06913727521896362

step: 90, loss: 0.00013135396875441074

step: 100, loss: 0.025957627221941948

step: 110, loss: 4.4257980334805325e-05

step: 120, loss: 0.00011589690984692425

step: 130, loss: 0.0035952446050941944

step: 140, loss: 2.7536923880688846e-05

step: 150, loss: 0.036455921828746796

step: 160, loss: 5.012469773646444e-05

step: 170, loss: 3.176489917677827e-05

epoch 12: dev_f1=0.8982630272952854, f1=0.8819277108433736, best_f1=0.8883495145631068

step: 0, loss: 0.03821155056357384

step: 10, loss: 0.0003802404389716685

step: 20, loss: 7.377835572697222e-05

step: 30, loss: 0.0002879873791243881

step: 40, loss: 0.00907466746866703

step: 50, loss: 0.0009396091336384416

step: 60, loss: 0.00038425420643761754

step: 70, loss: 0.00010995484626619145

step: 80, loss: 0.0004994368646293879

step: 90, loss: 7.7268727181945e-05

step: 100, loss: 0.000823839392978698

step: 110, loss: 8.463815174764022e-05

step: 120, loss: 0.0007589340093545616

step: 130, loss: 0.0024778309743851423

step: 140, loss: 0.000518661574460566

step: 150, loss: 0.008130606263875961

step: 160, loss: 0.020112628117203712

step: 170, loss: 0.0005365278339013457

epoch 13: dev_f1=0.885, f1=0.8725490196078431, best_f1=0.8883495145631068

step: 0, loss: 6.0869078879477456e-05

step: 10, loss: 0.0002496135130058974

step: 20, loss: 0.00037022228934802115

step: 30, loss: 0.0004820103058591485

step: 40, loss: 7.077387272147462e-05

step: 50, loss: 3.2736596040194854e-05

step: 60, loss: 0.011826667934656143

step: 70, loss: 3.923628173652105e-05

step: 80, loss: 3.611934153013863e-05

step: 90, loss: 5.8702393289422616e-05

step: 100, loss: 0.00014442068641074002

step: 110, loss: 3.5295714042149484e-05

step: 120, loss: 0.00028125476092100143

step: 130, loss: 0.00030628812965005636

step: 140, loss: 8.878779044607654e-05

step: 150, loss: 0.00017026634304784238

step: 160, loss: 2.6780564439832233e-05

step: 170, loss: 2.7901760404347442e-05

epoch 14: dev_f1=0.8866995073891626, f1=0.8747044917257683, best_f1=0.8883495145631068

step: 0, loss: 0.028318019583821297

step: 10, loss: 3.88492553611286e-05

step: 20, loss: 0.0003942775074392557

step: 30, loss: 4.164749407209456e-05

step: 40, loss: 3.657216439023614e-05

step: 50, loss: 8.858805085765198e-05

step: 60, loss: 2.933181713160593e-05

step: 70, loss: 0.0001400508190272376

step: 80, loss: 0.0006719550001434982

step: 90, loss: 0.018958209082484245

step: 100, loss: 6.64371982566081e-05

step: 110, loss: 4.3364161683712155e-05

step: 120, loss: 3.7095160223543644e-05

step: 130, loss: 0.0013479865156114101

step: 140, loss: 0.0006758897798135877

step: 150, loss: 3.7150974094402045e-05

step: 160, loss: 3.490054587018676e-05

step: 170, loss: 0.030469408258795738

epoch 15: dev_f1=0.8926829268292683, f1=0.8779342723004695, best_f1=0.8883495145631068











































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































0
CUDA_VISIBLE_DEVICES=0 python train_ditto.py               --task Textual/Company               --logdir results_ditto/               --finetuning               --batch_size 32               --lr 3e-5               --fp16               --lm bert               --n_epochs 3               --run_id 0 --summarize --da del --dk general






















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































1
